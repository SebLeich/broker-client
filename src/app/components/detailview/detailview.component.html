<mat-card *ngIf="currentService != null; else noService" class="main-content" (dblclick)=log()>
    <form class="form">
        <mat-form-field class="width">
            <input matInput class="headline primary-color" placeholder="Bezeichnung" name="serviceName"
                [(ngModel)]="currentService.serviceName">
        </mat-form-field>
        <mat-form-field class="width">
            <input matInput placeholder="Titel" name="serviceTitle" [(ngModel)]="currentService.serviceTitle">
        </mat-form-field>
        <mat-form-field class="width">
            <textarea matInput class="subtitle" placeholder="Beschreibung" name="serviceDescription"
                [(ngModel)]="currentService.serviceDescription"></textarea>
        </mat-form-field>
        <mat-form-field class="width">
            <input matInput placeholder="Verfügbarkeit" name="serviceAvailability"
                [(ngModel)]="currentService.serviceAvailability">
        </mat-form-field>
        <mat-form-field class="width">
            <mat-select [placeholder]=selectCategoryPlaceholder [ngModel]="currentService.cloudServiceCategoryId"
                (ngModelChange)="currentService.cloudServiceCategoryId=$event" name="cloudServiceCategoryId">
                <mat-option *ngFor="let c of serviceCategories" [value]="c.id">
                    {{ c.cloudServiceCategoryName }}
                </mat-option>
                <mat-option (click)="showCategoryAdder=true;" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Kategorie anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showCategoryAdder">
            <mat-form-field class="add-on">
                <input matInput #newCSCat placeholder="Neue Service Kategorie"
                    (keydown.enter)="addServiceCategory(newCSCat.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary"
                (click)="addServiceCategory(newCSCat.value)">
                Anlegen
            </button>
        </div>
        <mat-form-field class="width">
            <mat-select [placeholder]=selectServiceModelPlaceholder [ngModel]="currentService.cloudServiceModelId"
                (ngModelChange)="currentService.cloudServiceModelId=$event" name="cloudServiceModelId">
                <mat-option *ngFor="let m of serviceModels" [value]="m.id">
                    {{ m.cloudServiceModelName }}
                </mat-option>
                <mat-option (click)="showServiceModelAdder=true;" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Service Modell anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showServiceModelAdder">
            <mat-form-field class="add-on">
                <input matInput #newCSMod placeholder="Neues Service Modell"
                    (keydown.enter)="addServiceModel(newCSMod.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary" (click)="addServiceModel(newCSMod.value)">
                Anlegen
            </button>
        </div>
        <mat-form-field class="width">
            <mat-label>Lokalisation</mat-label>
            <mat-select (selectionChange)="setDataLocations($event)" [value]="currentService.dataLocationIds" multiple>
                <mat-option *ngFor="let l of dataLocations" [value]="l.id">{{l.toString()}}</mat-option>
                <mat-option (click)="showDataLocationAdder = true" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Lokalisation anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showDataLocationAdder">
            <mat-form-field class="add-on">
                <input matInput #newDL placeholder="Neue Lokalisation anlegen" (keydown.enter)="addDataLocation(newDL.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary" (click)="addDataLocation(newDL.value)">
                Anlegen
            </button>
        </div>
        <mat-form-field class="width">
            <mat-label>Zertifikate</mat-label>
            <mat-select (selectionChange)="setCertificates($event)" [value]="currentService.certificateIds" multiple>
                <mat-option *ngFor="let c of certificates" [value]="c.id">{{c.certificateName}}</mat-option>
                <mat-option (click)="showCertAdder = true" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Zertifikat anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showCertAdder">
            <mat-form-field class="add-on">
                <input matInput #newCert placeholder="Neues Zertifikat anlegen"
                    (keydown.enter)="addCertificate(newCert.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary" (click)="addCertificate(newCert.value)">
                Anlegen
            </button>
        </div>
        <mat-form-field *ngIf="displayStorageType" class="width">
            <mat-select [placeholder]="selectStorageTypePlaceholder" [ngModel]="currentService.storageTypeId"
                (ngModelChange)="currentService.storageTypeId=$event" name="storageTypeId">
                <mat-option *ngFor="let t of storageTypes" [value]="t.id">
                    {{ t.storageTypeDescription }}
                </mat-option>
                <mat-option (click)="showStorageTypeAdder=true;" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Speicherart anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showStorageTypeAdder">
            <mat-form-field class="add-on">
                <input matInput #newSType placeholder="Neue Speicherart"
                    (keydown.enter)="addStorageType(newCSCat.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary" (click)="addStorageType(newSType.value)">
                Anlegen
            </button>
        </div>
        <mat-form-field class="width">
            <mat-select [placeholder]=selectProviderPlaceholder [ngModel]="currentService.providerId"
                (ngModelChange)="currentService.providerId=$event" name="providerId">
                <mat-option *ngFor="let p of serviceProviders" [value]="p.id">
                    {{ p.providerName }}
                </mat-option>
                <mat-option (click)="showProviderAdder=true;" class="mat-option-adder">
                    <mat-icon class="icon">add</mat-icon>
                    Provider anlegen ...
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="showProviderAdder">
            <mat-form-field class="add-on">
                <input matInput #newCSProv placeholder="Neuer Service Provider"
                    (keydown.enter)="addServiceProvider(newCSProv.value)" />
            </mat-form-field>
            <button class="add-on-button" mat-raised-button color="primary"
                (click)="addServiceProvider(newCSProv.value)">
                Anlegen
            </button>
        </div>
        <mat-slide-toggle *ngIf="displayFileEncryption" class="bool-slider" (change)="fileEncryption=$event"
            [checked]=currentService.hasFileEncryption>Unterstützt der Service File-Encryption?</mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayFileLocking" class="bool-slider" (change)="fileLocking=$event"
            [checked]=currentService.hasFileLocking>Unterstützt der Service File-Locking?</mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayFilePermissions" class="bool-slider" (change)="filePermissions=$event"
            [checked]=currentService.hasFilePermissions>Unterstützt der Service File-Permissions?</mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayFileVersioning" class="bool-slider" (change)="fileVersioning=$event"
            [checked]=currentService.hasFileVersioning>
            Unterstützt der Service File-Versioning?
        </mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayReplication" class="bool-slider" (change)="fileReplication=$event"
            [checked]=currentService.hasReplication>
            Unterstützt der Service Replication?
        </mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayFileCompression" class="bool-slider" (change)="fileCompression=$event"
            [checked]=currentService.hasFileCompression>
            Unterstützt der Service File Compression?
        </mat-slide-toggle>
        <mat-slide-toggle *ngIf="displayDBMS" class="bool-slider" (change)="dbms=$event"
            [checked]=currentService.hasDBMS>Beinhaltet der Service ein Datenbankmanagmentsystem (DBMS)?
        </mat-slide-toggle>
    </form>
    <mat-card-title class="super-headline">
        <span class="spacer"></span>
        <div *ngIf="isLoggedIn" class="option-row">
            <button mat-icon-button class="btn-success" (click)=saveChanges()>
                <mat-icon>save</mat-icon>
            </button>
        </div>
    </mat-card-title>
</mat-card>
<ng-template #noService>
    FEHLER
</ng-template>
<mat-autocomplete #categories="matAutocomplete">
    <mat-option *ngFor="let c of serviceCategories" [value]="c.id">
        {{ c.cloudServiceCategoryName }}
    </mat-option>
</mat-autocomplete>